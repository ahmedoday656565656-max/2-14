<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>إليكِ..</title>
    <style>
        :root {
            --gold: #d4af37;
            --bg: #000000;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: white;
            font-family: 'Times New Roman', serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            text-align: center;
            touch-action: manipulation;
        }

        /* شاشة التحميل */
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 1s ease, visibility 1s;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(212, 175, 55, 0.1);
            border-top: 2px solid var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* المحتوى الرئيسي */
        #mainContent {
            opacity: 0;
            visibility: hidden;
            transition: opacity 2s ease;
            width: 85%;
            max-width: 450px;
            z-index: 1;
        }

        h1 {
            font-size: 1.3rem;
            color: var(--gold);
            font-weight: 300;
            margin-bottom: 20px;
        }

        #typewriter {
            font-size: 1.05rem;
            line-height: 2;
            min-height: 140px;
            color: #ccc;
            margin-bottom: 30px;
        }

        .btn {
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
            padding: 15px 35px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            opacity: 0;
            transition: 0.5s ease;
            pointer-events: none;
        }

        .btn.show { 
            opacity: 1; 
            pointer-events: auto; 
        }

        /* جزيئات الخلفية */
        .particle {
            position: absolute;
            background: var(--gold);
            border-radius: 50%;
            pointer-events: none;
            z-index: 0;
        }
    </style>
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <p id="loader-text" style="margin-top: 25px; font-size: 0.85rem; color: #888; letter-spacing: 2px; font-style: italic;">
            انتظري.. أحاول استجماع ما تبقى منا
        </p>
    </div>

    <div id="mainContent">
        <h1>إلى مَن كانت الأقرب..</h1>
        <div id="typewriter"></div>
        <button class="btn" id="playBtn" onclick="startExperience()">اضغطي هنا.. للذكرى</button>
    </div>

    <audio id="myAudio" preload="auto">
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <script>
        // دالة لإجبار اللودنك على الاختفاء بعد 5 ثوانٍ مهما حدث
        function hideLoader() {
            const loader = document.getElementById('loader');
            const content = document.getElementById('mainContent');
            
            loader.style.opacity = '0';
            loader.style.visibility = 'hidden';
            
            content.style.visibility = 'visible';
            content.style.opacity = '1';
            
            startTyping();
        }

        // تشغيل الإخفاء بعد وقت محدد (5 ثوانٍ) لضمان عدم التعليق
        setTimeout(hideLoader, 5000);

        // نص الكتابة
        const text = "في هذا الركن الهادئ من الإنترنت، لا توجد خوارزميات، فقط مشاعر لم يقتلها الوقت.
            كنتِ دائماً الجزء الأجمل في حياتي، واليوم أهدي لكِ هذا الكود كـ اعتذار صامت، أو ربما كـ حنين لم يجد له مكاناً في الواقع..";
        let index = 0;
        
        function startTyping() {
            const display = document.getElementById("typewriter");
            if (index < text.length) {
                display.innerHTML += text.charAt(index);
                index++;
                setTimeout(startTyping, 65);
            } else {
                document.getElementById("playBtn").classList.add("show");
            }
        }

        function startExperience() {
            const audio = document.getElementById("myAudio");
            audio.play().catch(e => console.log("Audio play deferred"));

            for(let i=0; i<30; i++) {
                createParticle();
            }

            const btn = document.getElementById("playBtn");
            btn.innerHTML = "استمعي للنبض..";
            btn.style.borderColor = "#fff";
            btn.style.color = "#fff";
        }

        function createParticle() {
            const p = document.createElement('div');
            p.className = 'particle';
            document.body.appendChild(p);
            const size = Math.random() * 3 + 1 + 'px';
            p.style.width = size; p.style.height = size;
            p.style.left = '50%'; p.style.top = '60%';
            const destX = (Math.random() - 0.5) * 500;
            const destY = (Math.random() - 0.5) * 500;
            p.animate([
                { transform: 'translate(0, 0)', opacity: 1 },
                { transform: translate(${destX}px, ${destY}px), opacity: 0 }
            ], { duration: 3000, easing: 'ease-out', fill: 'forwards' }).onfinish = () => p.remove();
        }
    </script>
</body>
</html>
