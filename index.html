<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إليكِ مع التحية</title>
    <style>
        :root {
            --bg-start: #e9e4f0;
            --bg-end: #d3d3d3;
            --accent: #5d5d5d;
            --text: #444444;
        }

        body {
            margin: 0; padding: 0;
            display: flex; justify-content: center; align-items: center;
            height: 100vh;
            /* خلفية متدرجة تتحرك */
            background: linear-gradient(270deg, var(--bg-start), var(--bg-end));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            color: var(--text);
            overflow: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            width: 80%; max-width: 380px;
            padding: 50px 30px;
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px); /* تأثير الزجاج الضبابي */
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 15px 35px rgba(0,0,0,0.05);
            text-align: center;
            transition: all 0.8s ease;
        }

        h2 {
            font-weight: 300; font-size: 1.2rem; line-height: 1.8;
            margin-bottom: 40px; min-height: 80px;
            letter-spacing: 0.5px;
        }

        .btn-wrapper { display: flex; flex-direction: column; gap: 20px; align-items: center; }

        button {
            background: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--accent);
            padding: 14px 40px;
            color: var(--accent);
            cursor: pointer;
            font-size: 0.9rem;
            width: 100%;
            max-width: 240px;
            border-radius: 50px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            outline: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        /* تفاعل الزر */
        button:hover, button:active {
            transform: scale(1.05);
            background: var(--accent);
            color: white;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        #no-btn {
            border: none; background: none; font-size: 0.8rem;
            text-decoration: underline; opacity: 0.5; color: var(--text);
            box-shadow: none;
        }
        #no-btn:hover { background: none; color: #880e4f; transform: none; }

        .fade-in { animation: fadeIn 1s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <audio id="myAudio" loop preload="auto" playsinline>
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <div class="container" id="box">
        <h2 id="text" class="fade-in">مرت سنوات طويلة، أليس كذلك؟</h2>
        <div class="btn-wrapper" id="actions">
            <button onclick="initAudio()">نعم، طويلة جداً</button>
        </div>
    </div>

    <script>
        const myAudio = document.getElementById("myAudio");
        let isPlaying = false;

        function initAudio() {
            if (!isPlaying) {
                myAudio.play().catch(e => console.log("Audio waiting for interaction"));
                isPlaying = true;
            }
            step(1);
        }

        const story = [
            {
                text: "رغم كل الغياب والمسافات، ما زال لذكراكِ هدوء لا يملكه غيركِ.",
                btn: "لماذا الآن؟",
                action: "step(2)"
            },
            {
                text: "لأن المشاعر الصادقة لا تنتهي بانتهاء الوقت، بل تنضج لتصبح أكثر عمقاً.",
                btn: "تحدث أكثر",
                action: "step(3)"
            },
            {
                text: "في هذا اليوم، أردت فقط أن أذكركِ بأنني لم أنسَ الأيام الجميلة يوماً.",
                btn: "ماذا تريد إذاً؟",
                action: "step(4)"
            }
        ];

        function step(index) {
            const box = document.getElementById('box');
            const text = document.getElementById('text');
            const actions = document.getElementById('actions');

            text.style.opacity = '0';
            actions.style.opacity = '0';

            setTimeout(() => {
                if (index <= story.length) {
                    const current = story[index - 1];
                    text.innerText = current.text;
                    actions.innerHTML = `<button onclick="ensurePlay(); ${current.action}">${current.btn}</button>`;
                } else {
                    text.innerText = "هل يمكننا أن نبدأ من جديد، ونعطي أنفسنا فرصة أخرى؟";
                    actions.innerHTML = `
                        <button onclick="ensurePlay(); finish()">أقبل المحاولة</button>
                        <button id="no-btn" onmouseover="escape()" ontouchstart="escape()">الوقت قد فات</button>
                    `;
                }
                text.style.opacity = '1';
                actions.style.opacity = '1';
                text.classList.remove('fade-in');
                void text.offsetWidth; // إعادة تشغيل الانيميشن
                text.classList.add('fade-in');
            }, 500);
        }

        function ensurePlay() { if (myAudio.paused) myAudio.play(); }

        function escape() {
            const b = document.getElementById('no-btn');
            b.style.position = 'fixed';
            b.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            b.style.top = Math.random() * (window.innerHeight - 50) + 'px';
        }

        function finish() {
            const box = document.getElementById('box');
            box.style.opacity = '0';
            setTimeout(() => {
                box.innerHTML = `
                    <h2 class="fade-in" style="font-style: italic;">شكراً لأنكِ منحتِ قلبي هذه اللحظة.. بانتظاركِ.</h2>
                    <div class="fade-in" style="margin-top:20px; opacity:0.3;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    </div>
                `;
                box.style.opacity = '1';
            }, 600);
        }
    </script>
</body>
</html>
